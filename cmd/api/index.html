<!DOCTYPE html>
<html lang="en">

    <head>
        <title>Chat Example</title>
        <script type="text/javascript">
            window.onload = function () {
                var conn;
                var question = document.getElementById("question");
                var answer = document.getElementById("answer");
                var log = document.getElementById("log");

                function appendLog(item) {
                    var doScroll = log.scrollTop > log.scrollHeight - log.clientHeight - 1;
                    log.appendChild(item);
                    if (doScroll) {
                        log.scrollTop = log.scrollHeight - log.clientHeight;
                    }
                }

                document.getElementById("form").onsubmit = function () {
                    if (!conn) {
                        return false;
                    }
                    if (!question.value && !answer.value) {
                        return false;
                    }
                    conn.send(`{"type":"answer", "sent_at":"2021-05-28T18:42:57.969135+03:00", "payload": { "question_id":"` + question.value + `", "answer_id":"` + answer.value + `"}}`);
                    question.value = "";
                    answer.value = "";
                    return false;
                };

                if (window["WebSocket"]) {
                    conn = new WebSocket("ws://localhost:8080/quiz/00cfe310-eb1e-42e5-9d6b-801e288a3f8f/play/eyJwIjp7IlVzZXJJRCI6IjJlMWUzNWMwLTFmOGYtNDViMy1hNTI1LTIwNTQ0NjVmOWMzYSIsIlVzZXJuYW1lIjoiam9obmRvZSIsIkNoYWxsZW5nZVJvb21JRCI6ImE0NTc0ZjIyLTRlYTAtNDU0NC1iNGI3LTAzZjg5NjY2ODY1NCJ9LCJlIjoxNjIyNjEyMDQxfQ.NTFlMTk2NzlhMTM3MmE2OWZhMGNkYmEwNjc3NDdiMDRiOGFhY2I0Mw");
                    conn.onclose = function (evt) {
                        var item = document.createElement("div");
                        item.innerHTML = "<b>Connection closed.</b>";
                        appendLog(item);
                    };
                    conn.onmessage = function (evt) {
                        var messages = evt.data.split('\n');
                        for (var i = 0; i < messages.length; i++) {
                            var item = document.createElement("div");
                            item.innerText = messages[i];
                            appendLog(item);
                        }
                    };
                } else {
                    var item = document.createElement("div");
                    item.innerHTML = "<b>Your browser does not support WebSockets.</b>";
                    appendLog(item);
                }
            };
        </script>
        <style type="text/css">
            html {
                overflow: hidden;
            }

            body {
                overflow: hidden;
                padding: 0;
                margin: 0;
                width: 100%;
                height: 100%;
                background: gray;
            }

            #log {
                background: white;
                margin: 0;
                padding: 0.5em 0.5em 0.5em 0.5em;
                position: absolute;
                top: 0.5em;
                left: 0.5em;
                right: 0.5em;
                bottom: 3em;
                overflow: auto;
            }

            #form {
                padding: 0 0.5em 0 0.5em;
                margin: 0;
                position: absolute;
                bottom: 1em;
                left: 0px;
                width: 100%;
                overflow: hidden;
            }
        </style>
    </head>

    <body>
        <pre id="log"></pre>
        <form id="form">
            <input type="text" id="question" size="64" autofocus />
            <input type="text" id="answer" size="64" />
            <input type="submit" value="Send" />
        </form>
    </body>

</html>